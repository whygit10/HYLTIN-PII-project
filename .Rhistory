geom_bar(position = 'stack', stat='identity')
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
ggplot(aes(fill=Family.Violence, x= Zip.Code, y=cnt)) +
geom_bar(position = 'stack', stat='identity')
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt) y=cnt)) +
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity')
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,-cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity')
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,-cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity')
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,-cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
filter(Occurred.Date >= ymd('2024-01-01')) %>%
group_by(Family.Violence, Zip.Code) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date)) %>%
filter(year >= 2023) %>%
group_by(Family.Violence, Zip.Code, year) %>%
pivot_wider(year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date)) %>%
filter(year >= 2023) %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date)) %>%
filter(year >= 2023) %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(year)
d1 %>%
mutate(year = year(Occurred.Date)) %>%
filter(year >= 2023) %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame()
d1 %>%
mutate(year = as.factor(year(Occurred.Date))) %>%
filter(year >= 2023) %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
year = as.factor(year) %>%
year = as.factor(year) %>%
filter(year == '2023' | year == '2024') %>%
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.factor(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(year) +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = character(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(year) +
coord_flip()
d1 %>%
mutate(year = year(Occurred.Date),
year = as.character(year)
) %>%
filter(year == '2023' | year == '2024') %>%
group_by(Family.Violence, Zip.Code, year) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(year) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(year)
) %>%
filter(years == '2023' | years == '2024') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2024') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2024') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
#arrange(desc(count(Zip.Code))) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>% head(20)
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>% head(20) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>% head(100) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>% head(75) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
?relocate
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = n()) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(cnt)) %>% head(75) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = n()) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(tot)) %>% head(20) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = n()) %>%
relocate(tot, .after = years)
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = sum(cnt)) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(tot)) %>% head(20) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = sum(cnt)) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(tot)) %>% head(50) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = sum(cnt)) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
#pivot_wider(names_from = year) %>%
arrange(desc(tot)) %>% head(100) %>%
#reorder(Zip.Code,-cnt) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
theme_set(theme_minimal())
# load a few R packages
pacman::p_load(here, knitr, tidyverse)
theme_set(theme_minimal())
d1 <- readRDS(here('data','processed-data','processedcrime.rds'))
summary(d1)
head(d1)
d1 %>% group_by(Occurred.Date) %>%
summarize(
cnt = n()
) %>% as.data.frame() %>%
ggplot(mapping = aes(x=Occurred.Date, y=cnt)) +
geom_line()
d1 %>%
mutate(years = year(Occurred.Date),
years = as.character(years)
) %>%
filter(years == '2023' | years == '2022') %>%
group_by(Family.Violence, Zip.Code, years) %>%
summarize(cnt = n(), .groups = 'drop') %>%
group_by(Zip.Code, years) %>%
mutate(tot = sum(cnt)) %>%
relocate(tot, .after = years) %>%
mutate(Zip.Code = as.character(Zip.Code)) %>%
as.data.frame() %>%
arrange(desc(tot)) %>% head(100) %>%
ggplot(aes(fill=Family.Violence, x= reorder(Zip.Code,cnt), y=cnt)) +
geom_bar(position = 'stack', stat='identity') +
facet_wrap(~years) +
coord_flip()
